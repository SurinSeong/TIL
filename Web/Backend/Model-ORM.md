# Django Model & ORM

## Django Model

- **DB의 테이블을 정의**하고 **데이터를 조작**할 수 있는 기능들을 제공
    - 테이블 구조를 설계하는 **청사진**

### model 클래스 살펴보기
 
- 작성한 모델 클래스는 최종적으로 DB에 다음과 같은 테이블 구조를 만든다.
- django.db.models 모듈의 Model이라는 부모 클래스를 상속받음.
- Model은 model에 관련된 모든 콛드가 이미 작성되어 있는 클래스이다.
- 구성
    1. 클래스 변수명 : 테이블의 각 **필드(열) 이름**
    2. model Field 클래스 : 테이블 필드의 **데이터 타입**
    3. model Field 클래스의 키워드 인자 (필드 옵션) : 테이블 필드의 **제약조건** 관련 설정
        - 제약조건 : 데이터가 올바르게 저장되고 관리되도록 하기 위한 규칙 
- 상속의 좋은점 : 파이썬 문법에 맞게 데이터베이스를 관리할 수 있다.

## Migrations

- 파이썬으로 작성한 클래스를 실제 데이터베이스에 반영하는 방법
- model 클래스의 **변경사항** (필드 생성, 수정, 삭제 등)을 DB에 **최종 반영**하는 방식

- Migrations 과정

1.  model class (설계도 초안) 생성
    - views.py에 사용할 클래스를 생성한다.

2.  migration 파일 (최종 설계도)
    - 데이터 베이스에 반영된다.

3.  db.sqlite3

- Migrations 핵심 명령어 2가지
- `$python manage.py makemigrations` : model class를 기반으로 **최종 설계도** (migration) 작성
- `$python manage.py migrate` : 최종 설계도를 **DB에 전달하여 반영**
    - sqlite3 생성된다.

- Migrate 후 DB 내에 생성된 테이블 확인
    - Article 모델 클래스로 만들어진 articles_article 테이블

- 이미 생성된 테이블에 필드를 추가해야 한다면?? >> **클래스에 테이블 추가**한다.
    - 이때, 데이터베이스의 값은 비어있으면 안된다.
    - 따라서, 필드를 추가해준다면, 이미 기존 테이블이 존재하기 때문에 필드를 추가할 때, 필드의 기본 값 설정이 필요하다.
        - 1) 현재 대화를 유지하며 직접 기본 값을 입력하는 방법 = 실행과정을 종료하지 않고 다음 번에 다시 물어본다.
         
            - 아무것도 입력하지 않고 enter 두번 누르면 django가 제안하는 기본 값으로 설정된다.
            - migrations 과정이 죵료된 후, 2번째 migration 파일 (설계도) 이 생성된 것을 확인할 수 있다.
          
        - 2) 현재 대화에서 나간 후, models.py에 기본값 관련 설정을 하는 방법
            
            - default 값에 대한 제약사항을 넣을 수 있다.
         
※ Model class에 **변경사항**이 생겼다면, 반드시 **새로운 설계도를 생성**하고 이를 **DB에 반영**해야 한다.

### 모델 필드

- Model Field : DB 테이블의 **필드**(열)을 정의하며, 해당 필드에 저장되는 **데이터 타입**과 **제약조건**을 정의
    - `CharField()` : **길이의 제한이 있는** 문자열을 넣을 때 사용. (필드의 최대 길이를 결정하는 **max_length는 필수 인자**이다.)
    - `TextField()` : 글자의 수가 많을 때 사용
    - `DateTimeField()` : 날짜와 시간을 넣을 때 사용
 
### Admin site
