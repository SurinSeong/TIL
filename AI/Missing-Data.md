# 데이터 결측이 모델의 성능에 미치는 영향

## 결측 데이터

### 모델 성능에 미치는 영향

- 데이터셋 크기 감소 → 학습 부족
- 통계적 왜곡 → 편향된 학습
- 예측 성능 저하 → 높은 오류율

### 처리 방법

![Image](https://github.com/user-attachments/assets/76d151fe-94da-44d8-8d58-394b29f7085f)

- 변수 타입이 수치형일 때의 전처리 방법과 범주형일 때의 전처리 방법이 다르다

| 방법 | 수치형 변수 | 범주형 변수 |
| --- | --- | --- |
| 삭제 | 행 또는 열 삭제 → 유효한 데이터가 삭제될 위험 존재 | 행 또는 열 삭제 → 유효한 데이터가 삭제될 위험 존재 |
| 단순대체 | 평균(mean), 중앙값(median), 최빈값(mode) | 최빈값(mode) |
| 고급대체 | KNN, 회귀모델 | KNN(하기 전 **범주를 라벨 인코딩으로 수치화**) |
| 보간 | 선형 보간법, 시계열 기반 대체 | 상위 또는 하위 데이터로 대체 |

## 결측 데이터 실습

### 실험 데이터

- **실험 데이터 설명** : 학생 성적 예측 데이터셋
- **종속 변수** : G3 (최종 성적)
- **데이터 크기** : 678행 X 33열
- 수치형(int) 변수 16개, 범주형(object) 변수 17개 존재

### 결측치 생성

- 데이터에서 **결측 데이터가 존재하지 않는다**.
    - 결측 데이터로 인한 모델의 성능을 확인하기 위해 **임의로 결측 데이터를 생성**했다.

### 수치형 변수

1. **중앙값** 또는 **평균값 대체**
    - 각 변수의 중앙값이나, 평균값으로 대체
    - 수치형 변수의 타입이 정수(int)이기 때문에, 평균값으로 대체 후 데이터 타입을 정수로 변환해줘야 한다.
    - `inplace=True` : 원본 데이터 자체를 바로 수정해, 수정된 결과를 새 변수에 저장할 필요가 없다.
    - `inplace=False` : 원본 데이터는 유지되고, 수정된 결과를 새 변수에 저장해야 한다.
2. **KNN Imputer**
    - KNN Imputation : 결측치 주변의 K개의 이웃 데이터 값으로 추정한다.
    - **거리(metric)를 이용한 유사도 기반**으로 대체한다.
    - Scikit-learn 라이브러리의 `KNNImputer`를 사용해서 결측치를 처리한다.

### 범주형 변수

1. **그룹별 최빈값** 대체
    - **age별로 데이터를 그룹화**하여 그룹 내 결측치를 처리한다.
    - 각 그룹에서 school 변수의 **최빈값**(`mode()[0]`)을 계산해서 결측치를 대체한다.
    - `transform()`을 사용해서 그룹별로 계산한 값을 원래 데이터 프레임의 형태에 맞게 변환한다.
2. **KNN Imputer**
    - 범주형 (문자열) 데이터를 모델이 처리할 수 있도록 **수치형 데이터로 인코딩**해야 한다.
    - **Label Encoding을 사용**해 문자열 값을 각기 다른 숫자로 매핑한다. (순서는 고려하지 않음)
    - **KNN Imputer**를 통해 결측치를 대체한다.
    - 결측치 대체 이후에는 **Label Encoding 역변환**하여 원래 범주형 값으로 복원한다. (필요 시)

### RandomForest 성능 확인

![Image](https://github.com/user-attachments/assets/6f8d0aa5-7c66-436a-a75b-e31cc3d9dd9b)

# 이상치와 모델의 민감도

## 이상치

### 모델 성능에 미치는 영향

- **평균, 분산과 같은 통계량을 크게 왜곡**하여 모델이 데이터의 일반적인 패턴을 학습하는 것에 어려움을 겪는다.
- 이상치를 처리하려다 보니 모델이 **과도하게 복잡**해지거나, **과적합**될 가능성이 커짐.
- 이상치가 포함된 데이터는 변수 간 관계를 잘못된 방향으로 보이게 해 데이터 분석 및 모델의 **해석의 신뢰성을 낮춘다**.

### 탐지 및 처리 방법

![Image](https://github.com/user-attachments/assets/2f41a69d-ab46-415c-b3ab-8e2c516ca005)

## 이상치 실습

### 실험 데이터셋

- **실험 데이터** : statsmodel 내부 데이터인 **sunspots** 데이터
- **설명** : 태양 흑점(sunspots) 활동을 측정한 시계열 데이터
- **데이터 크기** : 1750년 2008년까지의 연간 태양 흑점수 (**309**개)

### 실험 데이터셋 이상치 확인

- **Boxplot 시각화**를 통해 데이터 이상치를 확인한다.
- 총 8개의 이상치가 존재함.
- **주의할 점 : 데이터 도메인에 따라, 이상치가 아닐 수 있기 때문에 잘 처리해야 한다.**
- 다만, 이번 분석에서는 **해당값을 이상치로 간주**한다.

### 실험 데이터셋 이상치 처리

- 이상치를 IQR로 탐지 후, **interpolate(선형 보간)**법을 통해 대체해 줌.

### 시계열 모델링

- 이상치 전처리 전, 후의 성능을 확인하기 위해 모델 적용
- ARIMA에 계절성을 추가한 모델인 **Seasonal ARIMA**를 사용한다.
- RMSE로 성능 확인
    
    
    | 데이터 | RMSE |
    | --- | --- |
    | 원본 데이터 | 17.784 |
    | 이상치 처리 데이터 | 13.487 |

# 텍스트 데이터의 정제 사례

## 텍스트 데이터

### 품질 문제

- **오탈자** : “hapy”와 같은 오탈자는 모델의 어휘 이해를 방해한다.
- **중복 데이터** : 동일 리뷰의 반복은 모델의 편향을 초래한다.
- **문맥 왜곡** : “satisfied”가 “non satisfied”로 표기되면 감정 분석이 반대로 될 수 있다.

### 품질이 중요한 이유

![Image](https://github.com/user-attachments/assets/68aae4fb-2f6a-4737-a17c-c6f7b7d7b4e1)

## 텍스트 데이터 실습

### 실험 데이터셋

- 데이터셋 : 긍정, 부정 리뷰 데이터셋 (chatgpt 생성)
- 데이터 내부에 **오탈자** 및 **중복 데이터**, **특수 문자** 존재함

### 정제

1. **소문자 변환**
2. **오탈자 수정**
3. **중복 제거**
4. **특수문자 제거**
- **TextBlob**은 자연어 처리를 간단하게 수행할 수 있는 라이브러리이며, **오탈자** **수정**이 가능하다.
- **정규표현식**을 이용한 **중복 및 특수문자 제거**

### 정제 후 모델 성능 비교

- **TF-IDF 벡터화 진행** : 텍스트 데이터를 수치화하여 각 단어의 중요도를 계산한다.
- **Multinomial Naive Bayes** : **확률** 기반 텍스트 분류 모델
