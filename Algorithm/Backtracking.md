# 백트래킹 응용

## 문제 제시 : n-Queen 문제

- NxN 서양 장기판에서 배치한 Queen들이 서로 위협하지 않도록 n개의 Queen을 배치하는 문제
    - 어떤 두 Queen 도 서로를 위협하지 않아야 한다.
    - Queen을 배치한 n개의 위치는?
 
## 백트래킹 개념

- **여러가지 선택지**들이 존재하는 상황에서 한 가지를 선택한다.
- 선택이 이루어지면 **새로운 선택지들의 집합**이 생성된다.
- 이런 선택을 반복하면서 **최종 상태**에 도달한다.
    - 올바른 선택을 계속하면 **목표 상태**에 도달한다.
 
- 당첨 리프 노드 찾기
    
    - 루트에서 갈 수 있는 노드를 선택한다.
    - 꽝 노드까지 도달하면 최근의 선택으로 되돌아와서 다시 시작한다.
    - 더 이상의 선택지가 없다면, 이전의 선택지로 돌아가서 다른 선택을 한다.
    - 루트까지 돌아갔을 경우, 더 이상 선택지가 없다면 찾는 답이 없다.
 
- 4-Queens 문제로 축소해서 생각하기
    
    - 같은 행에 위치 할 수 없음.
    - 모든 경우의 수는 4 x 4 x 4 x 4 = 256
    - **상태공간트리**를 그려보자!
  
        - 루트 노드에서 리프노드까지의 경로는 해답 후보가 되는데, 깊이 우선 탐색을 하여, 그 해답 후보 중 해답을 찾을 수 있음.
        - 그러나 이 방법을 사용하면, **해답이 될 가능성이 전혀 없는 노드의 후손 노드들도 모두 검색**하기 때문에 비효율적이다.
        - 따라서, **모든 후보를 검사하지 않는 방향**으로 가야 한다.

- 백트래킹과 깊이 우선 탐색의 차이
    - **백트래킹** : 어떤 노드에서 출발하는 경로가 해결책으로 이어질 것 같지 않다면 더 이상 **그 경로를 따라가지 않음으로써 시도의 횟수를 줄인다**.

     
### 백트래킹 기법

- 어떤 노드의 **유망성을 점검**한 후, **유망하지 않다고 결**정되면, 그 노드의 부모로 **되돌아가** 다음 자식 노드로 간다.
- 어떤 노드를 방문했을 때, 그 노드를 포함한 경로가 **해답이 될 수 없으면** 그 노드는 **유망하지 않다**고 하며, 반대로 해답의 가능성이 있다면 유망하다고 한다.
- 가지치기 : **유망하지 않은 노드가 포함되는 경로는 더 이상 고려하지 않는다.**
- 절차
    1. **상태공간트리**의 **깊이 우선 탐색**을 실시
    2. 각 노드가 유망한지 점검
    3. 만일 그 노드가 유망하지 않으면, 그 노드의 부모 노드로 돌아가서 검색 

**- 완전 탐색 코드에서 시작해서 가지치기를 이용해 유망하지 않은 후보를 제외하는 방향으로 코드를 구현한다.**
